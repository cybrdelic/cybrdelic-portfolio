<!doctype html>
<html lang="en" data-theme="light">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>cybrdelic</title>
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Base monospace and display fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Cascadia+Code:wght@400;500;600;700&family=Courier+Prime:wght@400;700&family=IBM+Plex+Mono:wght@400;500;600;700&family=Inconsolata:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700;800&family=Roboto+Mono:wght@400;500;600;700&family=Source+Code+Pro:wght@400;500;600;700;800&family=Ubuntu+Mono:wght@400;700&family=Fira+Code:wght@400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Fun and unique display fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Audiowide&family=Bungee&family=Bungee+Hairline&family=Bungee+Inline&family=Bungee+Shade&family=Chakra+Petch:wght@400;500;600;700&family=Comfortaa:wght@400;500;600;700&family=Geologica:wght@400;500;700&family=Gugi&family=Josefin+Sans:wght@400;500;600;700&family=Major+Mono+Display&family=Megrim&family=Monofett&family=Monoton&family=Montserrat:wght@400;500;600;700;800&family=Nova+Mono&family=Orbitron:wght@400;500;600;700;800;900&family=Outfit:wght@400;500;600;700;800;900&family=Oxanium:wght@400;500;600;700&family=Poiret+One&family=Press+Start+2P&family=Quantico:wght@400;700&family=Rajdhani:wght@400;500;600;700&family=Righteous&family=Silkscreen&family=Smooch+Sans:wght@400;500;700;900&family=Space+Grotesk:wght@400;500;600;700&family=Space+Mono:wght@400;700&family=Syncopate:wght@400;700&family=Syne:wght@400;500;600;700;800&family=VT323&family=Wallpoet&family=Xanh+Mono&family=Yatra+One&family=Tourney:wght@400;500;700&family=Teko:wght@400;500;600;700&family=Exo+2:wght@400;500;600;700;800&family=Rubik+Glitch&family=Rubik+Mono+One&family=Rubik+Pixels&family=Rubik+Spray+Paint&family=Rubik+Vinyl&family=Goldman&display=swap"
        rel="stylesheet">

    <!-- Additional creative fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Moirai+One&family=Nabla&family=Noto+Sans+Mono:wght@400;500;600;700&family=Share+Tech+Mono&family=Silkscreen&family=Sometype+Mono:wght@400;500;600;700&family=Faster+One&family=Flow+Circular&family=Flow+Rounded&family=Gruppo&family=Keania+One&family=Kenia&family=Londrina+Outline&family=Plaster&display=swap"
        rel="stylesheet">

    <!-- Centralized CSS file that imports all modules -->
    <link rel="stylesheet" href="/static/css/main.css" />
    <!-- External dependencies - critical ones load normally, non-critical ones load async -->
    <script src="https://code.iconify.design/2/2.2.1/iconify.min.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.3.0/mermaid.min.js" defer></script>

    
    <!-- Add preload hints for critical resources when coming to project pages -->
    <link rel="preload" href="/static/css/project-detail.css" as="style">
    <link rel="preload" href="/static/js/documentation.js" as="script">
    
</head>

<body>
    <!-- Cyberpunk corner effects -->
    <div class="corner-effect corner-top-right"></div>
    <div class="corner-effect corner-bottom-left"></div>

    <div id="terminal">
        <nav class="nav">
            <a href="/" class="home-link">
                <div class="home-button">
                    <span class="icon">⌂</span>
                    <span class="text">home</span>
                </div>
            </a>
            <div class="nav-left stagger-children">
                <a href="#projects" class="cmd cmd-prompt">ls projects/</a>
                <a href="#whats-next" class="cmd cmd-prompt">./future</a>
                <a href="#contact" class="cmd cmd-prompt">./contact</a>
            </div>
            <div class="nav-right">
                <a href="https://github.com/cybrdelic" target="_blank" class="nav-action-button github-button">
                    <svg class="action-icon" viewBox="0 0 24 24" fill="currentColor" width="18" height="18">
                        <path
                            d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1.01.07 1.53 1.03 1.53 1.03.89 1.52 2.34 1.08 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z">
                        </path>
                    </svg>
                    <span class="action-text">GitHub</span>
                </a>
                <a href="#" class="nav-action-button theme-button" id="nav-theme-toggle">
                    <span class="action-icon theme-icon">☀️</span>
                    <span class="action-text">Theme</span>
                </a>
            </div>
        </nav>
        
<main class="project-detail-container">
    <!-- Project Header Section -->
    <header class="project-header-section">
        <div class="project-headline">
            <div class="project-title-container">
                <h1 class="project-title glitch-hover">Myriad.ai</h1>
                <div class="project-badge">Intelligent Software Copilot</div>
            </div>
            <div class="project-links">
                
                <a href="https:&#x2F;&#x2F;crates.io&#x2F;crates&#x2F;myriad" class="cmd highlight-on-hover" target="_blank" rel="noopener noreferrer">
                    Crates.io
                </a>
                
                <a href="https:&#x2F;&#x2F;github.com&#x2F;cybrdelic&#x2F;myriad" class="cmd highlight-on-hover" target="_blank" rel="noopener noreferrer">
                    GitHub
                </a>
                
            </div>
        </div>
    </header>

    <!-- Project Showcase Section -->
    <section class="project-showcase" id="" Myriad.ai>
        <div class="showcase-container">
            <div class="showcase-image-container glitch-on-hover">
                <img src="&#x2F;static&#x2F;images&#x2F;myriad.jpg" alt="Myriad.ai" class="showcase-image"
                    onclick="openModal(this)" />
                <div class="image-overlay">
                    <div class="overlay-content">
                        <div class="overlay-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M15 15l6 6m-6-6v4.8m0-4.8h4.8" />
                            </svg>
                        </div>
                        <span class="overlay-text">Click to enlarge</span>
                    </div>
                </div>
            </div>
            <div class="showcase-caption">Intelligent codebase exploration tool powered by Claude API</div>
        </div>

        <div class="project-overview">
            <div class="overview-content">
                <div class="overview-description">An AI-powered code exploration tool that helps developers navigate and understand complex codebases, and produce project planning&#x2F;documentation through contextual code analysis and natural language interaction.</div>

                <div class="tech-stack">
                    <h3 class="tech-stack-title">Technology Stack</h3>
                    <div class="tech-tags">
                        
                        <span class="tech-tag highlight-on-hover">
                            <span class="tag-icon">◆</span>Rust
                        </span>
                        
                        <span class="tech-tag highlight-on-hover">
                            <span class="tag-icon">◆</span>Claude API
                        </span>
                        
                        <span class="tech-tag highlight-on-hover">
                            <span class="tag-icon">◆</span>NLP
                        </span>
                        
                        <span class="tech-tag highlight-on-hover">
                            <span class="tag-icon">◆</span>Git
                        </span>
                        
                    </div>
                </div>
            </div>

            <div class="install-terminal">
                <div class="terminal-header">
                    <div class="window-controls">
                        <span class="window-control close"></span>
                        <span class="window-control minimize"></span>
                        <span class="window-control maximize"></span>
                    </div>
                    <div class="terminal-title">Installation</div>
                </div>
                <div class="terminal-content">
                    <div class="command-line">
                        <span class="terminal-prompt">$</span>
                        <span class="terminal-command">cargo install myriad</span>
                        <button class="copy-button" onclick="copyToClipboard(this)">
                            <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M8 4v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V7.242a2 2 0 0 0-.602-1.43L16.083 2.57A2 2 0 0 0 14.685 2H10a2 2 0 0 0-2 2z" />
                                <path d="M16 18v2a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h2" />
                            </svg>
                            <div class="confetti-container"></div>
                        </button>
                    </div>
                </div>
            </div>
        </div>

    </section>

    <div class="features-grid">
        
        <div class="feature-card card-hover">
            <div class="feature-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
            </div>
            <div class="feature-content">
                <h3 class="feature-title">Natural Language Search</h3>
                <p class="feature-description">Query your codebase using natural language and get contextually relevant results</p>
            </div>
        </div>
        
        <div class="feature-card card-hover">
            <div class="feature-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m12 6.253v13m0-13c10.832 5.477 9.246 5 7.5 5s4.168 5.477 3 6.253v13c4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253" />
                </svg>
            </div>
            <div class="feature-content">
                <h3 class="feature-title">Context Memory</h3>
                <p class="feature-description">Maintains conversation context for more intelligent interactions</p>
            </div>
        </div>
        
        <div class="feature-card card-hover">
            <div class="feature-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="m9 12h6m-6 4h6m2 5h7a2 2 0 01-2-2v5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707v19a2 2 0 01-2 2z" />
                </svg>
            </div>
            <div class="feature-content">
                <h3 class="feature-title">AI-Powered Contextual Indexing</h3>
                <p class="feature-description">Smart indexing system that understands user prompts and where the related code is</p>
            </div>
        </div>
        
        <div class="cta-button-container-wrapper">
            <div class="cta-button-container">
                <a href="http://localhost:8080/#" class="primary-button" target="_blank">
                    View Landing Page
                    <svg class="button-icon" viewBox="0 0 24 24">
                        <path d="M5 12h14M12 5l7 7-7 7" />
                    </svg>
                </a>
                <a href="https://github.com/cybrdelic" class="secondary-button btn-interaction" target="_blank">
                    <svg viewBox="0 0 24 24" class="button-icon">
                        <path
                            d="M12 2C6.477 2 2 6.477 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1.01.07 1.53 1.03 1.53 1.03.89 1.52 2.34 1.08 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z">
                        </path>
                    </svg>
                    GitHub
                </a>
            </div>
        </div>
    </div>

    
    <section class="documentation-section" id="DOCS">
        <div class="docs-sidebar">
            
            <button class="docs-nav-item active" data-tab="section-1">
                <span class="docs-nav-number">1</span>
                <span class="docs-nav-text">codebase_contextualization_and_indexing</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-2">
                <span class="docs-nav-number">2</span>
                <span class="docs-nav-text">conversational_chat</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-3">
                <span class="docs-nav-number">3</span>
                <span class="docs-nav-text">tui_architecture</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-4">
                <span class="docs-nav-number">4</span>
                <span class="docs-nav-text">basic-usage</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-5">
                <span class="docs-nav-number">5</span>
                <span class="docs-nav-text">installation</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-6">
                <span class="docs-nav-number">6</span>
                <span class="docs-nav-text">architecture</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-7">
                <span class="docs-nav-number">7</span>
                <span class="docs-nav-text">db_management</span>
            </button>
            
            <button class="docs-nav-item " data-tab="section-8">
                <span class="docs-nav-number">8</span>
                <span class="docs-nav-text">docs</span>
            </button>
            
        </div>


        <div class="docs-content">
            
            <div class="docs-panel active" id="section-1">
                <div class="markdown-content" data-flow-name="codebase_contextualization_and_indexing">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h2 id="codebase-contextualization-and-indexing-engine" class="markdown-heading-1 markdown-heading">Codebase Contextualization and Indexing Engine<a class="heading-anchor" href="#codebase-contextualization-and-indexing-engine">&#xB6;</a></h2><p class="markdown-paragraph">This document outlines the design, functionality, and production-level considerations for the codebase contextualization and indexing engine. The engine is a critical component designed to analyze, summarize, and integrate codebase information so that downstream services—such as an intelligent chat assistant—can leverage detailed project context in real time.</p><h3 id="table-of-contents" class="markdown-heading-2 markdown-heading">Table of Contents<a class="heading-anchor" href="#table-of-contents">&#xB6;</a></h3><ol class="ordered-list"><li class="list-item"><a href="#overview" class="markdown-link">Overview</a></li><li class="list-item"><a href="#architecture-overview" class="markdown-link">Architecture Overview</a></li><li class="list-item"><a href="#indexing-workflow" class="markdown-link">Indexing Workflow</a></li><li class="list-item"><a href="#ai-summarization--contextualization" class="markdown-link">AI Summarization & Contextualization</a></li><li class="list-item"><a href="#concurrency-error-handling--logging" class="markdown-link">Concurrency, Error Handling, & Logging</a></li><li class="list-item"><a href="#database--persistence" class="markdown-link">Database & Persistence</a></li><li class="list-item"><a href="#user-interface--developer-experience" class="markdown-link">User Interface & Developer Experience</a></li><li class="list-item"><a href="#security-configuration--production-considerations" class="markdown-link">Security, Configuration, & Production Considerations</a></li><li class="list-item"><a href="#scalability-and-maintenance" class="markdown-link">Scalability and Maintenance</a></li><li class="list-item"><a href="#future-enhancements" class="markdown-link">Future Enhancements</a></li><li class="list-item"><a href="#conclusion" class="markdown-link">Conclusion</a></li></ol><h3 id="overview" class="markdown-heading-2 markdown-heading">Overview<a class="heading-anchor" href="#overview">&#xB6;</a></h3><p class="markdown-paragraph">The engine automates the process of scanning a codebase, summarizing key elements of each file, and integrating these summaries into a comprehensive context for query processing. By aggregating file summaries, it enables an AI-powered assistant to provide informed responses that reference actual project details, thus significantly enhancing the quality of developer support and automated documentation.</p><h3 id="architecture-overview" class="markdown-heading-2 markdown-heading">Architecture Overview<a class="heading-anchor" href="#architecture-overview">&#xB6;</a></h3><h4 id="key-components" class="markdown-heading-3 markdown-heading">Key Components<a class="heading-anchor" href="#key-components">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Indexing Module:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">File Discovery:</strong> Utilizes a recursive file walker that respects  and other exclusion patterns.</li><li class="list-item"><strong class="markdown-strong">Tree Representation:</strong> Creates a  for each file, tracking its indexing progress and status.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Summarization Module:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">AI Integration:</strong> Sends file content to a third-party summarization API (Claude API) using tailored prompts that include language-specific instructions.</li><li class="list-item"><strong class="markdown-strong">Result Aggregation:</strong> Stores file summaries and language metadata in an in-memory index for rapid context building.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Chat & Context Integration:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Dynamic Context Assembly:</strong> Aggregates all file summaries to build a context-rich prompt that is combined with user queries.</li><li class="list-item"><strong class="markdown-strong">Interactive UI:</strong> Provides a terminal-based interface (via TUI) for live monitoring of indexing progress, logs, and chat interactions.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Database Layer:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Persistent Storage:</strong> Uses SQLite with a series of migrations to maintain tables for projects, files, code snippets, and contextualization indexes.</li><li class="list-item"><strong class="markdown-strong">Schema Management:</strong> Ensures the database structure is always aligned with the application’s evolving requirements.</li></ul></li></ul><h3 id="indexing-workflow" class="markdown-heading-2 markdown-heading">Indexing Workflow<a class="heading-anchor" href="#indexing-workflow">&#xB6;</a></h3><h4 id="file-discovery-and-selection" class="markdown-heading-3 markdown-heading">File Discovery and Selection<a class="heading-anchor" href="#file-discovery-and-selection">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Directory Traversal:</strong></p><ul class="unordered-list"><li class="list-item">Employs  to scan specified directories (e.g., , ), excluding non-relevant directories such as , , and .</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">File Filtering:</strong></p><ul class="unordered-list"><li class="list-item">Selects files based on extension (e.g., , ) to ensure only pertinent files are processed.</li></ul></li></ul><h4 id="progress-tracking" class="markdown-heading-3 markdown-heading">Progress Tracking<a class="heading-anchor" href="#progress-tracking">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Tree Nodes:</strong></p><ul class="unordered-list"><li class="list-item">Each file is represented by a  that tracks:<ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Filename:</strong> Absolute or relative path.</li><li class="list-item"><strong class="markdown-strong">Progress:</strong> A floating-point value (<span class="count-up" data-final-value="0">0</span>.<span class="count-up" data-final-value="0">0</span>–<span class="count-up" data-final-value="1">0</span>.<span class="count-up" data-final-value="0">0</span>) indicating the completion stage.</li><li class="list-item"><strong class="markdown-strong">Status:</strong> Descriptive state (e.g., "pending", "reading", "done", "failed").</li></ul></li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">UI Feedback:</strong></p><ul class="unordered-list"><li class="list-item">A progress bar and spinner in the terminal UI provide real-time feedback to the user, with color-coded status indicators (green for success, yellow for in-progress, red for errors).</li></ul></li></ul><h4 id="concurrent-processing" class="markdown-heading-3 markdown-heading">Concurrent Processing<a class="heading-anchor" href="#concurrent-processing">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Asynchronous File Reading:</strong></p><ul class="unordered-list"><li class="list-item">Leverages Tokio’s asynchronous I/O to read files without blocking the main thread.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Controlled Concurrency:</strong></p><ul class="unordered-list"><li class="list-item">Processes files concurrently with a set limit (e.g., <span class="count-up" data-final-value="16">0</span> simultaneous tasks) to balance throughput and system resource utilization.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Incremental Updates:</strong></p><ul class="unordered-list"><li class="list-item">Updates file progress in stages (reading, post-read, summarization complete) to ensure transparency and error tracking.</li></ul></li></ul><h3 id="ai-summarization---contextualization" class="markdown-heading-2 markdown-heading">AI Summarization & Contextualization<a class="heading-anchor" href="#ai-summarization---contextualization">&#xB6;</a></h3><h4 id="summarization-process" class="markdown-heading-3 markdown-heading">Summarization Process<a class="heading-anchor" href="#summarization-process">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Prompt Construction:</strong></p><ul class="unordered-list"><li class="list-item">The engine generates a prompt that includes the file’s content and specifies the code language (e.g., Rust or Markdown), ensuring the AI receives clear, actionable instructions.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">API Interaction:</strong></p><ul class="unordered-list"><li class="list-item">Communicates with the Claude API using a robust HTTP client, handling potential API errors and timeouts with detailed logging.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Response Integration:</strong></p><ul class="unordered-list"><li class="list-item">On success, the summary is stored alongside language metadata. If summarization fails, the error is logged and the file’s node is updated to indicate failure.</li></ul></li></ul><h4 id="context-building-for-chat" class="markdown-heading-3 markdown-heading">Context Building for Chat<a class="heading-anchor" href="#context-building-for-chat">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Aggregation:</strong></p><ul class="unordered-list"><li class="list-item">When a user initiates a chat, all successful file summaries are aggregated into a unified context.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Prompt Enrichment:</strong></p><ul class="unordered-list"><li class="list-item">The final prompt for the AI assistant combines the contextual information with the user’s query, enabling responses that are deeply informed by the project’s codebase.</li></ul></li></ul><h3 id="concurrency--error-handling----logging" class="markdown-heading-2 markdown-heading">Concurrency, Error Handling, & Logging<a class="heading-anchor" href="#concurrency--error-handling----logging">&#xB6;</a></h3><h4 id="concurrency-practices" class="markdown-heading-3 markdown-heading">Concurrency Practices<a class="heading-anchor" href="#concurrency-practices">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Asynchronous Streams:</strong></p><ul class="unordered-list"><li class="list-item">Uses futures and stream combinators to manage concurrency effectively.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Resource Management:</strong></p><ul class="unordered-list"><li class="list-item">Implements a fixed concurrency limit to avoid overwhelming system resources.</li></ul></li></ul><h4 id="error-handling" class="markdown-heading-3 markdown-heading">Error Handling<a class="heading-anchor" href="#error-handling">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Granular Error Reporting:</strong></p><ul class="unordered-list"><li class="list-item">Each operation (file reading, API calls) includes try/catch logic with detailed error messages.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Fallback Mechanisms:</strong></p><ul class="unordered-list"><li class="list-item">In cases of API failure, the system logs errors and provides user feedback via the UI.</li></ul></li></ul><h4 id="logging" class="markdown-heading-3 markdown-heading">Logging<a class="heading-anchor" href="#logging">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Structured Logging:</strong></p><ul class="unordered-list"><li class="list-item">Integrates with flexi_logger to record events to a file, ensuring that all key events (startup, file indexing, API calls, errors) are captured.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Real-Time Feedback:</strong></p><ul class="unordered-list"><li class="list-item">The terminal UI displays log entries, allowing developers to monitor progress and diagnose issues during indexing.</li></ul></li></ul><h3 id="database---persistence" class="markdown-heading-2 markdown-heading">Database & Persistence<a class="heading-anchor" href="#database---persistence">&#xB6;</a></h3><h4 id="schema-design" class="markdown-heading-3 markdown-heading">Schema Design<a class="heading-anchor" href="#schema-design">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Tables and Relationships:</strong></p><ul class="unordered-list"><li class="list-item">The database schema includes tables for projects, files, code snippets, and contextual indexes.</li><li class="list-item">Foreign key constraints enforce data integrity between related entities.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Migration Strategy:</strong></p><ul class="unordered-list"><li class="list-item">SQL migration files in the  directory are used to version control the database schema.</li><li class="list-item">Both "up" and "down" migration scripts are provided to ensure smooth schema evolution.</li></ul></li></ul><h4 id="production-considerations" class="markdown-heading-3 markdown-heading">Production Considerations<a class="heading-anchor" href="#production-considerations">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Configuration Management:</strong></p><ul class="unordered-list"><li class="list-item">Environment variables (e.g., , ) are used to manage sensitive configuration data.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Scalability:</strong></p><ul class="unordered-list"><li class="list-item">While SQLite is sufficient for small to medium-sized projects, the design allows for future migration to more scalable databases if required.</li></ul></li></ul><h3 id="user-interface---developer-experience" class="markdown-heading-2 markdown-heading">User Interface & Developer Experience<a class="heading-anchor" href="#user-interface---developer-experience">&#xB6;</a></h3><h4 id="terminal-ui--tui" class="markdown-heading-3 markdown-heading">Terminal UI (TUI)<a class="heading-anchor" href="#terminal-ui--tui">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Modular Design:</strong></p><ul class="unordered-list"><li class="list-item">The UI is composed of multiple panels (file tree, logs, chat view, progress indicators) using the <a href="https://github.com/ratatui-org/ratatui" class="markdown-link">ratatui</a> library.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Interactive Features:</strong></p><ul class="unordered-list"><li class="list-item">Command mode allows copying code snippets directly to the clipboard.</li><li class="list-item">Real-time progress updates and detailed logs help developers understand the indexing state and troubleshoot issues.</li></ul></li></ul><h4 id="developer-tools" class="markdown-heading-3 markdown-heading">Developer Tools<a class="heading-anchor" href="#developer-tools">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Debugging and State Inspection:</strong></p><ul class="unordered-list"><li class="list-item">Built-in logging and state-dump functions (e.g., ) provide insights into the current application state.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Command Shortcuts:</strong></p><ul class="unordered-list"><li class="list-item">Simple command shortcuts (e.g., , , ) streamline interactions for power users.</li></ul></li></ul><h3 id="security--configuration----production-considerations" class="markdown-heading-2 markdown-heading">Security, Configuration, & Production Considerations<a class="heading-anchor" href="#security--configuration----production-considerations">&#xB6;</a></h3><h4 id="security-best-practices" class="markdown-heading-3 markdown-heading">Security Best Practices<a class="heading-anchor" href="#security-best-practices">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Sensitive Data Management:</strong></p><ul class="unordered-list"><li class="list-item">API keys and database connection strings are managed through environment variables.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Access Control:</strong></p><ul class="unordered-list"><li class="list-item">Ensure that production systems enforce access controls and proper permissions on log files and configuration settings.</li></ul></li></ul><h4 id="configuration-and-deployment" class="markdown-heading-3 markdown-heading">Configuration and Deployment<a class="heading-anchor" href="#configuration-and-deployment">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Environment-Specific Settings:</strong></p><ul class="unordered-list"><li class="list-item">The application supports different configurations for development, testing, and production environments via environment variables and configuration files.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Monitoring & Alerts:</strong></p><ul class="unordered-list"><li class="list-item">Integrate with production monitoring tools to track performance, error rates, and resource utilization.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Robust API Communication:</strong></p><ul class="unordered-list"><li class="list-item">Implement retries and exponential backoff strategies for external API calls to handle transient failures gracefully.</li></ul></li></ul><h3 id="scalability-and-maintenance" class="markdown-heading-2 markdown-heading">Scalability and Maintenance<a class="heading-anchor" href="#scalability-and-maintenance">&#xB6;</a></h3><h4 id="performance-optimization" class="markdown-heading-3 markdown-heading">Performance Optimization<a class="heading-anchor" href="#performance-optimization">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Concurrency Tuning:</strong></p><ul class="unordered-list"><li class="list-item">Adjust the concurrency limit based on system capacity and workload demands.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Efficient Resource Usage:</strong></p><ul class="unordered-list"><li class="list-item">Asynchronous I/O and controlled task spawning ensure the engine remains responsive even under heavy loads.</li></ul></li></ul><h4 id="maintainability" class="markdown-heading-3 markdown-heading">Maintainability<a class="heading-anchor" href="#maintainability">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Modular Codebase:</strong></p><ul class="unordered-list"><li class="list-item">Clear separation of concerns between indexing, summarization, UI rendering, and database operations facilitates easier maintenance and testing.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Extensive Logging:</strong></p><ul class="unordered-list"><li class="list-item">Detailed logs and state-tracking enable rapid diagnosis and troubleshooting in production environments.</li></ul></li></ul><h3 id="future-enhancements" class="markdown-heading-2 markdown-heading">Future Enhancements<a class="heading-anchor" href="#future-enhancements">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Extended File Type Support:</strong></p><ul class="unordered-list"><li class="list-item">Add capabilities to index additional file types and programming languages as needed.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Enhanced AI Prompting:</strong></p><ul class="unordered-list"><li class="list-item">Refine the summarization prompts based on empirical feedback to improve AI response quality.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Scalable Data Storage:</strong></p><ul class="unordered-list"><li class="list-item">Consider migrating to a more scalable database solution (e.g., PostgreSQL) for larger projects.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Advanced Analytics:</strong></p><ul class="unordered-list"><li class="list-item">Implement usage analytics and performance metrics to drive further optimizations in indexing and summarization.</li></ul></li></ul><h3 id="conclusion" class="markdown-heading-2 markdown-heading">Conclusion<a class="heading-anchor" href="#conclusion">&#xB6;</a></h3><p class="markdown-paragraph">The codebase contextualization and indexing engine is built to meet production-level standards by incorporating robust asynchronous processing, comprehensive error handling, detailed logging, and secure configuration management. Its modular architecture and clear separation of concerns ensure that it can scale with project demands while providing an enriched context for AI-driven query responses. This documentation serves as a comprehensive guide for developers and system administrators, outlining both current functionalities and potential areas for future improvement.</p>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-2">
                <div class="markdown-content" data-flow-name="conversational_chat">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h2 id="conversational-chat-functionality" class="markdown-heading-1 markdown-heading">Conversational Chat Functionality<a class="heading-anchor" href="#conversational-chat-functionality">&#xB6;</a></h2><p class="markdown-paragraph">This document details the design, architecture, and production-level implementation of the conversational chat component. Beyond simply enabling an AI-driven conversation, the system incorporates a rich, interactive chat history that preserves context over multiple messages—transforming the conversation into a dynamic workspace. One particularly innovative feature is the ability to select individual code blocks and message chunks directly from the terminal. This granular control allows developers to focus on, navigate, and even copy specific parts of the conversation, such as code snippets or step-by-step instructions, significantly enhancing productivity.</p><h3 id="table-of-contents" class="markdown-heading-2 markdown-heading">Table of Contents<a class="heading-anchor" href="#table-of-contents">&#xB6;</a></h3><ol class="ordered-list"><li class="list-item"><a href="#overview" class="markdown-link">Overview</a></li><li class="list-item"><a href="#architecture-overview" class="markdown-link">Architecture Overview</a></li><li class="list-item"><a href="#interactive-chat-history" class="markdown-link">Interactive Chat History</a></li><li class="list-item"><a href="#innovative-code-block-and-message-chunk-selection" class="markdown-link">Innovative Code Block and Message Chunk Selection</a></li><li class="list-item"><a href="#chat-interface-and-ui-rendering" class="markdown-link">Chat Interface and UI Rendering</a></li><li class="list-item"><a href="#message-parsing-and-rendering" class="markdown-link">Message Parsing and Rendering</a></li><li class="list-item"><a href="#ai-integration-and-contextualization" class="markdown-link">AI Integration and Contextualization</a></li><li class="list-item"><a href="#command-mode-and-interactivity" class="markdown-link">Command Mode and Interactivity</a></li><li class="list-item"><a href="#error-handling-and-logging" class="markdown-link">Error Handling and Logging</a></li><li class="list-item"><a href="#conclusion" class="markdown-link">Conclusion</a></li></ol><h3 id="overview" class="markdown-heading-2 markdown-heading">Overview<a class="heading-anchor" href="#overview">&#xB6;</a></h3><p class="markdown-paragraph">The conversational chat module enables users to interact with an intelligent AI assistant through a terminal-based interface. It aggregates context from an indexed codebase to enrich responses and preserves a detailed chat history. This history is not a static log but a structured record that supports nuanced interactions, such as code block selection and message chunk selection, turning the chat window into an interactive development workspace.</p><h3 id="architecture-overview" class="markdown-heading-2 markdown-heading">Architecture Overview<a class="heading-anchor" href="#architecture-overview">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Modular Components:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Chat View:</strong> Renders the multi-panel interface, including the message area, input field, status indicator, and logs panel.</li><li class="list-item"><strong class="markdown-strong">Chat Message:</strong> Represents individual messages, each broken down into multiple chunks (text, code blocks, step-by-step instructions) for targeted interaction.</li><li class="list-item"><strong class="markdown-strong">AI Integration:</strong> Communicates with the Claude API to generate context-aware responses by incorporating aggregated summaries from the codebase.</li><li class="list-item"><strong class="markdown-strong">Command Handling:</strong> Supports a command mode for advanced interactions, such as copying specific code snippets or focusing on particular messages.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Asynchronous Processing:</strong><br>The system leverages Tokio to ensure that UI updates, API calls, and background tasks (such as indexing and summarization) occur concurrently without blocking user interactions.</p></li></ul><h3 id="interactive-chat-history" class="markdown-heading-2 markdown-heading">Interactive Chat History<a class="heading-anchor" href="#interactive-chat-history">&#xB6;</a></h3><p class="markdown-paragraph">The chat history is a cornerstone of the conversational module. It preserves detailed context from prior interactions and is designed to be dynamic and interactive:</p><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Context Preservation:</strong><br>Every message is stored along with its segmented content, ensuring that context is maintained throughout long conversations.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Rich Formatting:</strong><br>Messages are parsed into distinct chunks, enabling specialized formatting for text, code blocks, and instructional steps.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Enhanced AI Responses:</strong><br>By referencing the detailed chat history, the AI assistant can generate responses that are more informed and context-sensitive.</p></li></ul><h3 id="innovative-code-block-and-message-chunk-selection" class="markdown-heading-2 markdown-heading">Innovative Code Block and Message Chunk Selection<a class="heading-anchor" href="#innovative-code-block-and-message-chunk-selection">&#xB6;</a></h3><p class="markdown-paragraph">A standout feature of the system is its innovative approach to handling chat history:</p><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Granular Message Segmentation:</strong><br>Instead of presenting a monolithic text block, messages are divided into discrete chunks. This allows the system to treat code blocks, plain text, and numbered instructions as separate entities.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Interactive Code Block Selection:</strong><br>Users can select and focus on individual code blocks. For example, with simple commands, you can copy a specific code snippet directly from the chat history.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Focused Navigation:</strong><br>The interface provides visual cues (such as highlighting or reversed colors) to indicate which message chunk is currently active, allowing users to navigate between different parts of a message easily.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Productivity Enhancements:</strong><br>This design transforms the chat window into an interactive workspace where developers can quickly extract and utilize relevant code segments, streamlining debugging and knowledge sharing.</p></li></ul><h3 id="chat-interface-and-ui-rendering" class="markdown-heading-2 markdown-heading">Chat Interface and UI Rendering<a class="heading-anchor" href="#chat-interface-and-ui-rendering">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Terminal User Interface (TUI):</strong><br>Built with <a href="https://github.com/ratatui-org/ratatui" class="markdown-link">ratatui</a>, the chat interface consists of:</p><ul class="unordered-list"><li class="list-item">A <strong class="markdown-strong">message panel</strong> that displays the conversation history with support for smooth scrolling.</li><li class="list-item">An <strong class="markdown-strong">input field</strong> where users type their queries.</li><li class="list-item">A <strong class="markdown-strong">status indicator</strong> that shows real-time updates (e.g., an animated "Thinking..." spinner).</li><li class="list-item">A <strong class="markdown-strong">logs panel</strong> that provides diagnostic information and operational feedback.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Responsive Layout:</strong><br>The layout dynamically adjusts to terminal size, ensuring a consistent and user-friendly experience.</p></li></ul><h3 id="message-parsing-and-rendering" class="markdown-heading-2 markdown-heading">Message Parsing and Rendering<a class="heading-anchor" href="#message-parsing-and-rendering">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Chunk-Based Message Structure:</strong><br>Each chat message is parsed into multiple chunks:</p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Text Chunks:</strong> The core conversational text.</li><li class="list-item"><strong class="markdown-strong">Code Blocks:</strong> Rendered with syntax highlighting and selectable for individual operations.</li><li class="list-item"><strong class="markdown-strong">Instruction Steps:</strong> Formatted as ordered lists for clarity.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Visual Focus and Styling:</strong><br>The system visually distinguishes the active (focused) chunk using modified styles such as reversed colors, enabling intuitive navigation and interaction.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Wrapping and Formatting:</strong><br>The rendering process ensures that all content is wrapped appropriately and displayed in a consistent format across different terminal sizes.</p></li></ul><h3 id="ai-integration-and-contextualization" class="markdown-heading-2 markdown-heading">AI Integration and Contextualization<a class="heading-anchor" href="#ai-integration-and-contextualization">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Context Aggregation:</strong><br>Prior to sending a query to the AI, the system aggregates contextual summaries from the indexed codebase. This context is prepended to the user's question to form a detailed prompt.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Structured Prompt Formation:</strong><br>The prompt is structured as follows:</p><p class="markdown-paragraph">"Based on this codebase context:<br>[Aggregated Summaries]<br>Answer this question: [User Query]"</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Claude API Interaction:</strong><br>The system sends this prompt to the Claude API using asynchronous HTTP requests, and then parses and integrates the response into the chat history.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Token Usage Tracking:</strong><br>Details about token usage are logged for performance monitoring and future optimization.</p></li></ul><h3 id="command-mode-and-interactivity" class="markdown-heading-2 markdown-heading">Command Mode and Interactivity<a class="heading-anchor" href="#command-mode-and-interactivity">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Command Shortcuts:</strong><br>Users can activate a command mode (using ) to execute various actions:</p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">:</strong> Copies the nth code block from the focused message.</li><li class="list-item"><strong class="markdown-strong">:</strong> Changes the focus to the nth message in the conversation.</li><li class="list-item"><strong class="markdown-strong"></strong>: Lists available commands.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Keyboard Navigation:</strong><br>Standard key bindings (arrow keys, Enter, Esc) enable smooth movement within the chat interface, facilitating quick access to different parts of the chat history.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Immediate Feedback:</strong><br>Commands result in instant UI updates and logging, ensuring that users are always aware of the system state.</p></li></ul><h3 id="error-handling-and-logging" class="markdown-heading-2 markdown-heading">Error Handling and Logging<a class="heading-anchor" href="#error-handling-and-logging">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Robust Error Management:</strong><br>The system implements comprehensive error handling, particularly around asynchronous operations and API calls. Any errors are logged in detail to assist with debugging.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Non-Blocking Operations:</strong><br>Even if errors occur (for example, during API calls), the system continues to operate without disrupting the user experience.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Real-Time Logging:</strong><br>A dedicated logging component captures events and errors, displaying them in the UI and recording them in log files for later analysis.</p></li></ul><h3 id="conclusion" class="markdown-heading-2 markdown-heading">Conclusion<a class="heading-anchor" href="#conclusion">&#xB6;</a></h3><p class="markdown-paragraph">The conversational chat functionality is a sophisticated component that combines an intelligent AI assistant with a dynamic, context-rich chat history. Its innovative design—including granular code block and message chunk selection—transforms the chat interface into an interactive workspace ideal for developers. By maintaining detailed context and offering precise navigation and selection features, the system delivers a highly productive, production-grade chat experience.</p>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-3">
                <div class="markdown-content" data-flow-name="tui_architecture">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h2 id="tui-architecture-documentation" class="markdown-heading-1 markdown-heading">TUI Architecture Documentation<a class="heading-anchor" href="#tui-architecture-documentation">&#xB6;</a></h2><p class="markdown-paragraph">This document explains the architecture of the terminal user interface (TUI) used throughout the application. It covers the overall directory structure, key screens, layout components, key handlers, and how user input is processed to deliver an interactive, production-grade experience.</p><h3 id="table-of-contents" class="markdown-heading-2 markdown-heading">Table of Contents<a class="heading-anchor" href="#table-of-contents">&#xB6;</a></h3><ol class="ordered-list"><li class="list-item"><a href="#directory-structure" class="markdown-link">Directory Structure</a></li><li class="list-item"><a href="#screens-and-layouts" class="markdown-link">Screens and Layouts</a><ul class="unordered-list"><li class="list-item"><a href="#splash-screen" class="markdown-link">Splash Screen</a></li><li class="list-item"><a href="#indexing-screen" class="markdown-link">Indexing Screen</a></li><li class="list-item"><a href="#chat-screen" class="markdown-link">Chat Screen</a></li><li class="list-item"><a href="#database-details-screen" class="markdown-link">Database Details Screen</a></li></ul></li><li class="list-item"><a href="#key-handlers-and-user-input" class="markdown-link">Key Handlers and User Input</a></li><li class="list-item"><a href="#ui-components-and-rendering" class="markdown-link">UI Components and Rendering</a></li><li class="list-item"><a href="#state-management-and-transitions" class="markdown-link">State Management and Transitions</a></li><li class="list-item"><a href="#conclusion" class="markdown-link">Conclusion</a></li></ol><h3 id="directory-structure" class="markdown-heading-2 markdown-heading">Directory Structure<a class="heading-anchor" href="#directory-structure">&#xB6;</a></h3><p class="markdown-paragraph">The source code is organized into several modules that each handle a specific aspect of the TUI:</p><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">src/</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">build.rs</strong> – Build script that sets up environment variables.</li><li class="list-item"><strong class="markdown-strong">chat_view.rs</strong> – Renders the main chat interface including message panels, input areas, and logs.</li><li class="list-item"><strong class="markdown-strong">chat_message.rs</strong> – Defines the structure and rendering of individual chat messages (split into chunks such as text, code, or steps).</li><li class="list-item"><strong class="markdown-strong">code_snippet.rs</strong> – Manages code snippets, including language detection and snippet selection.</li><li class="list-item"><strong class="markdown-strong">db_details_view.rs</strong> – Renders the database details screen.</li><li class="list-item"><strong class="markdown-strong">indexing_view.rs</strong> – Provides the UI for the codebase indexing process, including progress and file tree panels.</li><li class="list-item"><strong class="markdown-strong">log_view.rs</strong> – Implements the logging panel that displays runtime logs.</li><li class="list-item"><strong class="markdown-strong">splash_screen.rs</strong> – Renders the initial splash screen with a menu.</li><li class="list-item"><strong class="markdown-strong">status_indicator.rs</strong> – Displays real-time status messages (e.g., processing spinners).</li><li class="list-item"><strong class="markdown-strong">db.rs</strong> – Handles database connectivity and migrations.</li><li class="list-item">Additional modules (e.g., <strong class="markdown-strong">chat_message.rs</strong>, <strong class="markdown-strong">code_snippet.rs</strong>) contribute to the overall functionality.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">migrations/</strong> – Contains SQL migration scripts that manage the database schema.</p></li></ul><h3 id="screens-and-layouts" class="markdown-heading-2 markdown-heading">Screens and Layouts<a class="heading-anchor" href="#screens-and-layouts">&#xB6;</a></h3><p class="markdown-paragraph">The TUI is divided into multiple screens, each with its own layout and purpose. The primary screens include:</p><h4 id="splash-screen" class="markdown-heading-3 markdown-heading">Splash Screen<a class="heading-anchor" href="#splash-screen">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Purpose:</strong><br>Acts as the entry point to the application.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Features:</strong></p><ul class="unordered-list"><li class="list-item">Displays ASCII art and a menu with options such as "Start Chat", "DB Details", and "Quit".</li><li class="list-item">Allows navigation using arrow keys and selection with Enter.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Module:</strong><br>Implemented in .</p></li></ul><h4 id="indexing-screen" class="markdown-heading-3 markdown-heading">Indexing Screen<a class="heading-anchor" href="#indexing-screen">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Purpose:</strong><br>Provides visual feedback during the codebase indexing process.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Layout:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Status Header:</strong> Displays a spinner, the number of files indexed, and elapsed time.</li><li class="list-item"><strong class="markdown-strong">File Tree Panel:</strong> Lists files to be indexed with a progress bar and color indicators.</li><li class="list-item"><strong class="markdown-strong">Overall Progress Panel:</strong> Shows a combined progress bar for all files.</li><li class="list-item"><strong class="markdown-strong">Logs Panel:</strong> Displays real-time logs on the right side.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Module:</strong><br>Implemented in .</p></li></ul><h4 id="chat-screen" class="markdown-heading-3 markdown-heading">Chat Screen<a class="heading-anchor" href="#chat-screen">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Purpose:</strong><br>The main interface for interacting with the AI assistant.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Layout:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Message Panel:</strong> Shows the conversation history. Each message is broken down into chunks (text, code blocks, instructions).</li><li class="list-item"><strong class="markdown-strong">Input Field:</strong> Where the user types messages.</li><li class="list-item"><strong class="markdown-strong">Status Indicator:</strong> Displays system status such as "Thinking..." with animated spinners.</li><li class="list-item"><strong class="markdown-strong">Logs Panel:</strong> Provides real-time logging of events.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Modules:</strong><br>Implemented in  and supported by .</p></li></ul><h4 id="database-details-screen" class="markdown-heading-3 markdown-heading">Database Details Screen<a class="heading-anchor" href="#database-details-screen">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Purpose:</strong><br>Displays detailed information about the database schema, migrations, and connection details.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Layout:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Details Grid:</strong> Shows connection details (URL, version) and metadata (table count, migrations).</li><li class="list-item"><strong class="markdown-strong">Tables Grid:</strong> Lists table names and their SQL definitions.</li><li class="list-item"><strong class="markdown-strong">Markdown Instructions:</strong> Provides SQLx CLI instructions for managing the database.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Module:</strong><br>Implemented in .</p></li></ul><h3 id="key-handlers-and-user-input" class="markdown-heading-2 markdown-heading">Key Handlers and User Input<a class="heading-anchor" href="#key-handlers-and-user-input">&#xB6;</a></h3><p class="markdown-paragraph">The TUI implements a robust key handling mechanism to support navigation and interaction across screens:</p><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Global Key Events:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Esc:</strong> Cancels indexing or exits a focused message.</li><li class="list-item"><strong class="markdown-strong">Ctrl+C:</strong> Exits the application.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Screen-Specific Handlers:</strong></p><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Splash Screen:</strong></p><ul class="unordered-list"><li class="list-item">Up/Down arrows for menu navigation.</li><li class="list-item">Enter key to select an option.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Indexing Screen:</strong></p><ul class="unordered-list"><li class="list-item">Logs “Esc” to cancel indexing and transition to the Chat Screen.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Chat Screen:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Arrow Keys:</strong> Navigate through chat messages and focus individual message chunks.</li><li class="list-item"><strong class="markdown-strong">Enter:</strong> Sends a message or copies the currently focused chunk if one is selected.</li><li class="list-item"><strong class="markdown-strong">Backspace, PageUp, PageDown:</strong> Manage text input and scrolling.</li><li class="list-item"><strong class="markdown-strong">Colon (:)</strong>: Enters command mode for advanced actions (e.g., copying a code block using  or focusing a message using ).</li></ul></li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Command Mode:</strong><br>In this mode, users can execute commands such as:</p><ul class="unordered-list"><li class="list-item"> – Copies the nth code block from the focused message.</li><li class="list-item"> – Sets focus to a specific message in the conversation.</li><li class="list-item"> – Displays available commands.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Implementation:</strong><br>Key handling is implemented across modules such as , , and in the main event loop in .</p></li></ul><h3 id="ui-components-and-rendering" class="markdown-heading-2 markdown-heading">UI Components and Rendering<a class="heading-anchor" href="#ui-components-and-rendering">&#xB6;</a></h3><p class="markdown-paragraph">The TUI leverages the <strong class="markdown-strong">ratatui</strong> library for drawing components:</p><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Panels and Layouts:</strong><br>Flexible layout managers (using horizontal and vertical splits) allow screens to be composed of multiple widgets.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Widgets:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Paragraphs:</strong> Used for displaying text (e.g., logs, messages, instructions).</li><li class="list-item"><strong class="markdown-strong">Blocks:</strong> Provide borders and titles for visual grouping.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Custom Rendering:</strong></p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Message Rendering:</strong> Each chat message is rendered by iterating through its chunks, applying different styles based on whether a chunk is focused.</li><li class="list-item"><strong class="markdown-strong">Progress Bars and Spinners:</strong> Dynamically rendered using formatted strings and animated frames.</li></ul></li></ul><h3 id="state-management-and-transitions" class="markdown-heading-2 markdown-heading">State Management and Transitions<a class="heading-anchor" href="#state-management-and-transitions">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Application State:</strong><br>The main application state is maintained in the  struct (defined in ), which holds the current screen, chat messages, indexing status, and other UI state variables.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Screen Transitions:</strong><br>Transitions between screens (Splash, Indexing, Chat, DB Details) are controlled by state changes triggered by key events or completion of background tasks.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Concurrency:</strong><br>The system uses asynchronous locks (via ) to safely update shared state across concurrent tasks, such as background indexing and chat response simulation.</p></li></ul><h3 id="conclusion" class="markdown-heading-2 markdown-heading">Conclusion<a class="heading-anchor" href="#conclusion">&#xB6;</a></h3><p class="markdown-paragraph">The TUI architecture is designed to provide a seamless and interactive user experience in the terminal. By organizing the code into dedicated modules, defining clear screen layouts, and implementing comprehensive key handlers, the system enables users to navigate complex information—such as codebase indexing, dynamic chat conversations, and detailed database views—with ease. The innovative approach to message chunking and code block selection further transforms the terminal interface into a powerful development workspace.</p>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-4">
                <div class="markdown-content" data-flow-name="basic-usage">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h2 id="basic-usage-guide" class="markdown-heading-1 markdown-heading">Basic Usage Guide<a class="heading-anchor" href="#basic-usage-guide">&#xB6;</a></h2><p class="markdown-paragraph">Learn how to use myriad's core features for exploring and understanding your codebase.</p><h3 id="getting-started" class="markdown-heading-2 markdown-heading">Getting Started<a class="heading-anchor" href="#getting-started">&#xB6;</a></h3><p class="markdown-paragraph">myriad provides an intuitive interface for interacting with your codebase using natural language. This guide covers the fundamental operations and best practices for effective usage.</p><h4 id="natural-language-search" class="markdown-heading-3 markdown-heading">Natural Language Search<a class="heading-anchor" href="#natural-language-search">&#xB6;</a></h4><p class="markdown-paragraph">myriad's search functionality understands natural language queries and provides contextually relevant results. When searching:</p><ol class="ordered-list"><li class="list-item">Be specific about what you're looking for</li><li class="list-item">Include relevant technical terms</li><li class="list-item">Frame your query as a question or request</li><li class="list-item">Use domain-specific terminology when applicable</li></ol><h4 id="code-analysis" class="markdown-heading-3 markdown-heading">Code Analysis<a class="heading-anchor" href="#code-analysis">&#xB6;</a></h4><p class="markdown-paragraph">The analysis feature provides detailed insights into your codebase:</p><ol class="ordered-list"><li class="list-item">Architectural patterns</li><li class="list-item">Dependencies and relationships</li><li class="list-item">Data flow</li><li class="list-item">Security considerations</li><li class="list-item">Performance implications</li></ol><h4 id="using-context" class="markdown-heading-3 markdown-heading">Using Context<a class="heading-anchor" href="#using-context">&#xB6;</a></h4><p class="markdown-paragraph">myriad maintains context throughout your session, enabling more intelligent and relevant interactions:</p><ol class="ordered-list"><li class="list-item">Previous queries inform future results</li><li class="list-item">Related code segments are automatically linked</li><li class="list-item">Patterns and relationships are preserved</li><li class="list-item">Historical interactions guide recommendations</li></ol><h3 id="best-practices" class="markdown-heading-2 markdown-heading">Best Practices<a class="heading-anchor" href="#best-practices">&#xB6;</a></h3><p class="markdown-paragraph">To get the most out of myriad:</p><ol class="ordered-list"><li class="list-item">Start with broad queries and narrow down</li><li class="list-item">Use the context feature to build understanding</li><li class="list-item">Leverage previous searches for better results</li><li class="list-item">Combine multiple search strategies</li><li class="list-item">Save and organize important findings</li></ol><h3 id="advanced-features" class="markdown-heading-2 markdown-heading">Advanced Features<a class="heading-anchor" href="#advanced-features">&#xB6;</a></h3><p class="markdown-paragraph">Explore advanced capabilities:</p><ol class="ordered-list"><li class="list-item">Custom search patterns</li><li class="list-item">Integration with development tools</li><li class="list-item">Automated documentation generation</li><li class="list-item">Codebase metrics and insights</li></ol>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-5">
                <div class="markdown-content" data-flow-name="installation">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h3 id="myriad" class="markdown-heading-2 markdown-heading">myriad<a class="heading-anchor" href="#myriad">&#xB6;</a></h3><p class="markdown-paragraph">myriad is a command-line application written in Rust that aims to help developers explore and understand their codebase more effectively. It leverages natural language processing and AI models from Anthropic to provide relevant information about the codebase in response to natural language queries.</p><h4 id="key-features" class="markdown-heading-3 markdown-heading">Key Features<a class="heading-anchor" href="#key-features">&#xB6;</a></h4><ol class="ordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Codebase Indexing</strong>:</p><ul class="unordered-list"><li class="list-item">myriad scans the specified codebase directory and indexes all the source files (Rust, Python, Go, JavaScript, TypeScript, Java, C, C++, Markdown, and Toml files).</li><li class="list-item">It generates concise summaries for each file using Anthropic's Claude AI model, making it easier to understand the purpose and functionality of different components.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Natural Language Queries</strong>:</p><ul class="unordered-list"><li class="list-item">Users can ask questions about the codebase in natural language, and myriad will provide relevant information based on the indexed files and summaries.</li><li class="list-item">The application supports a conversational mode, allowing users to have an interactive dialogue with the AI assistant.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Contextual Responses</strong>:</p><ul class="unordered-list"><li class="list-item">myriad takes into account the conversation history and relevant code context to provide accurate and contextual responses.</li><li class="list-item">It intelligently searches and ranks the indexed files based on their relevance to the user's query, ensuring that the most pertinent information is presented.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Interactive CLI</strong>:</p><ul class="unordered-list"><li class="list-item">myriad offers an interactive command-line interface (CLI) with various features for seamless interaction and navigation.</li><li class="list-item">Users can browse and view summaries for individual files, manage conversations, and perform various actions like copying responses to the clipboard or saving them to files.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Response Management</strong>:</p><ul class="unordered-list"><li class="list-item">Responses from the AI can be easily copied to the clipboard or saved to files for future reference.</li><li class="list-item">myriad maintains a conversation history, allowing users to review previous queries and responses.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Caching and Optimization</strong>:</p><ul class="unordered-list"><li class="list-item">myriad implements caching mechanisms to avoid redundant indexing and summaries, improving performance and reducing API call costs.</li><li class="list-item">It tracks file modification times and only re-indexes files that have been modified since the last run.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Token and Cost Tracking</strong>:</p><ul class="unordered-list"><li class="list-item">myriad keeps track of the number of tokens used for input, cache writes, cache hits, and output, providing transparency into the token usage and associated costs.</li><li class="list-item">It calculates and displays the total token usage and estimated cost for each interaction, helping users manage their API usage and budget.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Extensibility</strong>:</p><ul class="unordered-list"><li class="list-item">The project is designed with a modular structure and separation of concerns, making it easier to maintain and extend the codebase in the future.</li><li class="list-item">The integration with Anthropic's Claude AI model can be extended or replaced with other language models if desired.</li></ul></li></ol><h4 id="installation-and-setup" class="markdown-heading-3 markdown-heading">Installation and Setup<a class="heading-anchor" href="#installation-and-setup">&#xB6;</a></h4><p class="markdown-paragraph">myriad can be installed using Cargo, the Rust package manager. It requires an API key from Anthropic, which needs to be added to the user's  file (or the appropriate shell configuration file) as an environment variable.</p><p class="markdown-paragraph">Please refer to the project's README file for detailed instructions on installation, setup, and usage.</p><h4 id="usage" class="markdown-heading-3 markdown-heading">Usage<a class="heading-anchor" href="#usage">&#xB6;</a></h4><p class="markdown-paragraph">After installation, users can run the  command from the terminal to start the interactive CLI. The main menu provides options to enter chat mode, browse the indexed files, view help, and quit the application.</p><p class="markdown-paragraph">In chat mode, users can ask questions about the codebase in natural language, and myriad will provide relevant information based on the indexed files and summaries. Various commands are available to manage the conversation, such as clearing the history, saving/loading conversations, and exiting the chat mode.</p><h4 id="codebase-structure" class="markdown-heading-3 markdown-heading">Codebase Structure<a class="heading-anchor" href="#codebase-structure">&#xB6;</a></h4><p class="markdown-paragraph">The myriad codebase is organized into several modules and files:</p><ul class="unordered-list"><li class="list-item">: The entry point of the application, containing the main function and high-level logic.</li><li class="list-item">: Defines constants used throughout the application, such as API URLs, models, and UI constants.</li><li class="list-item">Structs and enums: myriad defines several structs and enums to represent data structures like messages, conversations, API call logs, and index caches.</li><li class="list-item">Helper functions: The codebase includes various helper functions for tasks like file operations, API calls, codebase indexing, response generation, and more.</li></ul><p class="markdown-paragraph">The project follows best practices for Rust development, including error handling, asynchronous programming with Tokio, and modular design.</p><h4 id="dependencies" class="markdown-heading-3 markdown-heading">Dependencies<a class="heading-anchor" href="#dependencies">&#xB6;</a></h4><p class="markdown-paragraph">myriad relies on several external crates and libraries, including:</p><ul class="unordered-list"><li class="list-item">: For making HTTP requests to the Anthropic API.</li><li class="list-item">: For serialization and deserialization of data structures.</li><li class="list-item">: For handling Git ignore patterns during codebase scanning.</li><li class="list-item">: For creating interactive command-line interfaces.</li><li class="list-item">: For providing a readline-like interface for user input.</li><li class="list-item">: For displaying progress bars and spinners.</li><li class="list-item">: For displaying tabular data in the terminal.</li><li class="list-item">: For handling date and time operations.</li><li class="list-item">: For tokenizing and counting tokens in prompts and responses.</li></ul><p class="markdown-paragraph">Please refer to the  file for the complete list of dependencies and their versions.</p>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-6">
                <div class="markdown-content" data-flow-name="architecture">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h2 id="architectural-overview" class="markdown-heading-1 markdown-heading">Architectural Overview<a class="heading-anchor" href="#architectural-overview">&#xB6;</a></h2><p class="markdown-paragraph">Understanding myriad's technical architecture and implementation details.</p><h3 id="core-components" class="markdown-heading-2 markdown-heading">Core Components<a class="heading-anchor" href="#core-components">&#xB6;</a></h3><p class="markdown-paragraph">myriad is built with a modular architecture that emphasizes performance, reliability, and extensibility:</p><h4 id="1--query-engine" class="markdown-heading-3 markdown-heading"><span class="count-up" data-final-value="1">0</span>. Query Engine<a class="heading-anchor" href="#1--query-engine">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item">Natural language processing pipeline</li><li class="list-item">Query optimization and transformation</li><li class="list-item">Context management system</li><li class="list-item">Response generation</li></ul><h4 id="2--indexing-system" class="markdown-heading-3 markdown-heading"><span class="count-up" data-final-value="2">0</span>. Indexing System<a class="heading-anchor" href="#2--indexing-system">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item">Incremental codebase indexing</li><li class="list-item">Semantic understanding</li><li class="list-item">Relationship mapping</li><li class="list-item">Change detection</li></ul><h4 id="3--claude-api-integration" class="markdown-heading-3 markdown-heading"><span class="count-up" data-final-value="3">0</span>. Claude API Integration<a class="heading-anchor" href="#3--claude-api-integration">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item">Request handling and optimization</li><li class="list-item">Response processing</li><li class="list-item">Error handling and retry logic</li><li class="list-item">Rate limiting and caching</li></ul><h4 id="4--storage-layer" class="markdown-heading-3 markdown-heading"><span class="count-up" data-final-value="4">0</span>. Storage Layer<a class="heading-anchor" href="#4--storage-layer">&#xB6;</a></h4><ul class="unordered-list"><li class="list-item">SQLite database integration</li><li class="list-item">Cache management</li><li class="list-item">Data persistence</li><li class="list-item">Query optimization</li></ul><h3 id="system-architecture" class="markdown-heading-2 markdown-heading">System Architecture<a class="heading-anchor" href="#system-architecture">&#xB6;</a></h3><p class="markdown-paragraph">The system follows a microservices architecture:</p><ol class="ordered-list"><li class="list-item"><p class="markdown-paragraph">API Gateway</p><ul class="unordered-list"><li class="list-item">Request routing</li><li class="list-item">Authentication</li><li class="list-item">Rate limiting</li><li class="list-item">Load balancing</li></ul></li><li class="list-item"><p class="markdown-paragraph">Core Services</p><ul class="unordered-list"><li class="list-item">Query processing</li><li class="list-item">Indexing</li><li class="list-item">Context management</li><li class="list-item">Response generation</li></ul></li><li class="list-item"><p class="markdown-paragraph">Support Services</p><ul class="unordered-list"><li class="list-item">Logging</li><li class="list-item">Monitoring</li><li class="list-item">Analytics</li><li class="list-item">Error tracking</li></ul></li></ol><h3 id="performance-considerations" class="markdown-heading-2 markdown-heading">Performance Considerations<a class="heading-anchor" href="#performance-considerations">&#xB6;</a></h3><p class="markdown-paragraph">Key performance optimizations include:</p><ol class="ordered-list"><li class="list-item">Incremental indexing</li><li class="list-item">Response caching</li><li class="list-item">Parallel processing</li><li class="list-item">Lazy loading</li><li class="list-item">Query optimization</li></ol><h3 id="security-features" class="markdown-heading-2 markdown-heading">Security Features<a class="heading-anchor" href="#security-features">&#xB6;</a></h3><p class="markdown-paragraph">Built-in security measures:</p><ol class="ordered-list"><li class="list-item">API key management</li><li class="list-item">Request validation</li><li class="list-item">Rate limiting</li><li class="list-item">Access control</li><li class="list-item">Data encryption</li></ol>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-7">
                <div class="markdown-content" data-flow-name="db_management">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h2 id="database-management-and-migration" class="markdown-heading-1 markdown-heading">Database Management and Migration<a class="heading-anchor" href="#database-management-and-migration">&#xB6;</a></h2><p class="markdown-paragraph">This document details the design, implementation, and operational aspects of the database management layer in the system. It covers how the project uses SQLite and SQLx for persistent storage, how migrations are managed and applied, and how the system exposes database details through its user interface. This guide is intended to assist developers and administrators in understanding the database architecture, troubleshooting issues, and planning future enhancements.</p><h3 id="table-of-contents" class="markdown-heading-2 markdown-heading">Table of Contents<a class="heading-anchor" href="#table-of-contents">&#xB6;</a></h3><ol class="ordered-list"><li class="list-item"><a href="#overview" class="markdown-link">Overview</a></li><li class="list-item"><a href="#architecture-overview" class="markdown-link">Architecture Overview</a></li><li class="list-item"><a href="#migration-management" class="markdown-link">Migration Management</a></li><li class="list-item"><a href="#database-initialization-and-connection" class="markdown-link">Database Initialization and Connection</a></li><li class="list-item"><a href="#schema-inspection-and-debugging" class="markdown-link">Schema Inspection and Debugging</a></li><li class="list-item"><a href="#ui-integration-for-db-details" class="markdown-link">UI Integration for DB Details</a></li><li class="list-item"><a href="#security-configuration-and-production-considerations" class="markdown-link">Security, Configuration, and Production Considerations</a></li><li class="list-item"><a href="#scalability-and-future-enhancements" class="markdown-link">Scalability and Future Enhancements</a></li><li class="list-item"><a href="#conclusion" class="markdown-link">Conclusion</a></li></ol><h3 id="overview" class="markdown-heading-2 markdown-heading">Overview<a class="heading-anchor" href="#overview">&#xB6;</a></h3><p class="markdown-paragraph">The system uses SQLite as the primary database engine for storing project data, code snippets, chat messages, and contextual indexes. Database management is handled through SQLx with a robust migration strategy. The architecture is designed for simplicity in development while allowing for potential migration to more scalable solutions if required.</p><h3 id="architecture-overview" class="markdown-heading-2 markdown-heading">Architecture Overview<a class="heading-anchor" href="#architecture-overview">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Connection Pooling:</strong><br>A connection pool is created using SQLx’s , ensuring efficient reuse of database connections.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Migration Framework:</strong><br>Migrations are embedded at compile time using the SQLx  macro. This approach enforces version control of the database schema and simplifies deployment.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Environment Integration:</strong><br>The system uses environment variables (e.g., ) to configure the database connection. Defaults are provided if no environment variable is set.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Separation of Concerns:</strong><br>Database management is encapsulated within a dedicated module, with a clear API for initialization, migration, and schema inspection. This isolation supports easier maintenance and testing.</p></li></ul><h3 id="migration-management" class="markdown-heading-2 markdown-heading">Migration Management<a class="heading-anchor" href="#migration-management">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Migration Files:</strong><br>SQL migration scripts are stored in the  directory. Each migration is versioned and includes both "up" and "down" scripts. Examples include:</p><ul class="unordered-list"><li class="list-item">Creating and dropping tables for projects, code snippets, files, and contextual indexes.</li><li class="list-item">Managing changes in project-related entities such as user flows and requirements.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Version Control:</strong><br>The  macro automatically collects and orders migrations. At runtime, the system logs available migrations and applies any pending changes.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Rollback Capabilities:</strong><br>Down migration scripts are provided for safe rollback, ensuring that schema changes can be reversed if necessary.</p></li></ul><h3 id="database-initialization-and-connection" class="markdown-heading-2 markdown-heading">Database Initialization and Connection<a class="heading-anchor" href="#database-initialization-and-connection">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Initialization Routine:</strong><br>The  function handles the complete initialization process:</p><ul class="unordered-list"><li class="list-item">Constructs a connection string based on the provided database path or environment variable.</li><li class="list-item">Sets up connection options with error logging enabled.</li><li class="list-item">Creates a connection pool with a maximum number of connections.</li><li class="list-item">Applies migrations to ensure the schema is up-to-date.</li><li class="list-item">Dumps the schema for debugging and logs the current migration version.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Error Handling:</strong><br>Errors during connection setup or migration are captured and logged, allowing for prompt troubleshooting in production environments.</p></li></ul><h3 id="schema-inspection-and-debugging" class="markdown-heading-2 markdown-heading">Schema Inspection and Debugging<a class="heading-anchor" href="#schema-inspection-and-debugging">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Logging Migrations:</strong><br>Each migration is logged with its version and description. This helps in verifying that the expected migrations have been applied.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Schema Dumping:</strong><br>The system queries the  table to retrieve and log the names and definitions of all tables. This provides an at-a-glance view of the current database schema for debugging purposes.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Version Tracking:</strong><br>The applied database version is queried from the migrations table, ensuring that the system is aware of its schema state.</p></li></ul><h3 id="ui-integration-for-db-details" class="markdown-heading-2 markdown-heading">UI Integration for DB Details<a class="heading-anchor" href="#ui-integration-for-db-details">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Database Details View:</strong><br>A dedicated user interface component (rendered via TUI) displays key database details:</p><ul class="unordered-list"><li class="list-item"><strong class="markdown-strong">Connection Details:</strong> Shows the active database URL and current version.</li><li class="list-item"><strong class="markdown-strong">Metadata:</strong> Displays the number of tables and migrations applied.</li><li class="list-item"><strong class="markdown-strong">Schema Overview:</strong> Lists table names and their SQL definitions.</li><li class="list-item"><strong class="markdown-strong">SQLx CLI Instructions:</strong> Provides step-by-step guidance for using the SQLx CLI to inspect and manage the database, enhancing developer productivity.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Interactivity:</strong><br>The UI allows users to navigate the database details and scroll through schema information, making it a practical tool for administrators.</p></li></ul><h3 id="security--configuration--and-production-considerations" class="markdown-heading-2 markdown-heading">Security, Configuration, and Production Considerations<a class="heading-anchor" href="#security--configuration--and-production-considerations">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Sensitive Data Management:</strong><br>The system uses environment variables (e.g., ) to store sensitive configuration. This prevents hardcoding credentials and allows for secure configuration management.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Access Controls:</strong><br>In production, appropriate access permissions should be enforced on the database file and log files to prevent unauthorized access.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Error Reporting and Logging:</strong><br>Comprehensive logging ensures that any issues with migrations or connection errors are captured and can be addressed quickly.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Configuration Flexibility:</strong><br>The design allows for easy changes in configuration for different environments (development, staging, production), facilitating smooth deployments.</p></li></ul><h3 id="scalability-and-future-enhancements" class="markdown-heading-2 markdown-heading">Scalability and Future Enhancements<a class="heading-anchor" href="#scalability-and-future-enhancements">&#xB6;</a></h3><ul class="unordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Database Scalability:</strong><br><span class="count-up" data-final-value="123">0</span><br>While SQLite is sufficient for small to medium workloads, the modular design of the database layer allows for a future migration to more robust databases like PostgreSQL.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Migration Automation:</strong><br>Enhancements could include automated rollback procedures and more sophisticated migration testing to ensure zero-downtime deployments.</p><p class="markdown-paragraph"><span class="count-up" data-final-value="14">0</span></p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Monitoring and Metrics:</strong><br>Integrating database performance monitoring tools will help in tracking query performance and identifying bottlenecks.</p></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Enhanced CLI Tools:</strong><br>Future improvements may include more detailed SQLx CLI instructions and integration with automated deployment pipelines.</p></li></ul><h3 id="conclusion" class="markdown-heading-2 markdown-heading">Conclusion<a class="heading-anchor" href="#conclusion">&#xB6;</a></h3><p class="markdown-paragraph">The database management layer is a critical component of the system, designed with production-level standards in mind. It leverages SQLx for efficient connection pooling and migration management, employs comprehensive logging for debugging, and integrates seamlessly with the UI for real-time schema inspection. This documentation provides a clear guide for developers and administrators to understand, manage, and extend the database functionality, ensuring the system remains robust, secure, and scalable.</p>
                </div>
            </div>
            
            <div class="docs-panel hidden" id="section-8">
                <div class="markdown-content" data-flow-name="docs">
                    <!-- Content will load instantly but might be further enhanced by JavaScript -->
                    <h3 id="myriad" class="markdown-heading-2 markdown-heading">myriad<a class="heading-anchor" href="#myriad">&#xB6;</a></h3><p class="markdown-paragraph">myriad is a command-line application written in Rust that aims to help developers explore and understand their codebase more effectively. It leverages natural language processing and AI models from Anthropic to provide relevant information about the codebase in response to natural language queries.</p><h4 id="key-features" class="markdown-heading-3 markdown-heading">Key Features<a class="heading-anchor" href="#key-features">&#xB6;</a></h4><ol class="ordered-list"><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Codebase Indexing</strong>:</p><ul class="unordered-list"><li class="list-item">myriad scans the specified codebase directory and indexes all the source files (Rust, Python, Go, JavaScript, TypeScript, Java, C, C++, Markdown, and Toml files).</li><li class="list-item">It generates concise summaries for each file using Anthropic's Claude AI model, making it easier to understand the purpose and functionality of different components.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Natural Language Queries</strong>:</p><ul class="unordered-list"><li class="list-item">Users can ask questions about the codebase in natural language, and myriad will provide relevant information based on the indexed files and summaries.</li><li class="list-item">The application supports a conversational mode, allowing users to have an interactive dialogue with the AI assistant.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Contextual Responses</strong>:</p><ul class="unordered-list"><li class="list-item">myriad takes into account the conversation history and relevant code context to provide accurate and contextual responses.</li><li class="list-item">It intelligently searches and ranks the indexed files based on their relevance to the user's query, ensuring that the most pertinent information is presented.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Interactive CLI</strong>:</p><ul class="unordered-list"><li class="list-item">myriad offers an interactive command-line interface (CLI) with various features for seamless interaction and navigation.</li><li class="list-item">Users can browse and view summaries for individual files, manage conversations, and perform various actions like copying responses to the clipboard or saving them to files.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Response Management</strong>:</p><ul class="unordered-list"><li class="list-item">Responses from the AI can be easily copied to the clipboard or saved to files for future reference.</li><li class="list-item">myriad maintains a conversation history, allowing users to review previous queries and responses.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Caching and Optimization</strong>:</p><ul class="unordered-list"><li class="list-item">myriad implements caching mechanisms to avoid redundant indexing and summaries, improving performance and reducing API call costs.</li><li class="list-item">It tracks file modification times and only re-indexes files that have been modified since the last run.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Token and Cost Tracking</strong>:</p><ul class="unordered-list"><li class="list-item">myriad keeps track of the number of tokens used for input, cache writes, cache hits, and output, providing transparency into the token usage and associated costs.</li><li class="list-item">It calculates and displays the total token usage and estimated cost for each interaction, helping users manage their API usage and budget.</li></ul></li><li class="list-item"><p class="markdown-paragraph"><strong class="markdown-strong">Extensibility</strong>:</p><ul class="unordered-list"><li class="list-item">The project is designed with a modular structure and separation of concerns, making it easier to maintain and extend the codebase in the future.</li><li class="list-item">The integration with Anthropic's Claude AI model can be extended or replaced with other language models if desired.</li></ul></li></ol><h4 id="installation-and-setup" class="markdown-heading-3 markdown-heading">Installation and Setup<a class="heading-anchor" href="#installation-and-setup">&#xB6;</a></h4><p class="markdown-paragraph">myriad can be installed using Cargo, the Rust package manager. It requires an API key from Anthropic, which needs to be added to the user's  file (or the appropriate shell configuration file) as an environment variable.</p><p class="markdown-paragraph">Please refer to the project's README file for detailed instructions on installation, setup, and usage.</p><h4 id="usage" class="markdown-heading-3 markdown-heading">Usage<a class="heading-anchor" href="#usage">&#xB6;</a></h4><p class="markdown-paragraph">After installation, users can run the  command from the terminal to start the interactive CLI. The main menu provides options to enter chat mode, browse the indexed files, view help, and quit the application.</p><p class="markdown-paragraph">In chat mode, users can ask questions about the codebase in natural language, and myriad will provide relevant information based on the indexed files and summaries. Various commands are available to manage the conversation, such as clearing the history, saving/loading conversations, and exiting the chat mode.</p><h4 id="codebase-structure" class="markdown-heading-3 markdown-heading">Codebase Structure<a class="heading-anchor" href="#codebase-structure">&#xB6;</a></h4><p class="markdown-paragraph">The myriad codebase is organized into several modules and files:</p><ul class="unordered-list"><li class="list-item">: The entry point of the application, containing the main function and high-level logic.</li><li class="list-item">: Defines constants used throughout the application, such as API URLs, models, and UI constants.</li><li class="list-item">Structs and enums: myriad defines several structs and enums to represent data structures like messages, conversations, API call logs, and index caches.</li><li class="list-item">Helper functions: The codebase includes various helper functions for tasks like file operations, API calls, codebase indexing, response generation, and more.</li></ul><p class="markdown-paragraph">The project follows best practices for Rust development, including error handling, asynchronous programming with Tokio, and modular design.</p><h4 id="dependencies" class="markdown-heading-3 markdown-heading">Dependencies<a class="heading-anchor" href="#dependencies">&#xB6;</a></h4><p class="markdown-paragraph">myriad relies on several external crates and libraries, including:</p><ul class="unordered-list"><li class="list-item">: For making HTTP requests to the Anthropic API.</li><li class="list-item">: For serialization and deserialization of data structures.</li><li class="list-item">: For handling Git ignore patterns during codebase scanning.</li><li class="list-item">: For creating interactive command-line interfaces.</li><li class="list-item">: For providing a readline-like interface for user input.</li><li class="list-item">: For displaying progress bars and spinners.</li><li class="list-item">: For displaying tabular data in the terminal.</li><li class="list-item">: For handling date and time operations.</li><li class="list-item">: For tokenizing and counting tokens in prompts and responses.</li></ul><p class="markdown-paragraph">Please refer to the  file for the complete list of dependencies and their versions.</p>
                </div>
            </div>
            
        </div>

    </section>
    

    
<section id="FUTURE">
    <div class="container">
        <div class="future-projects-container">
            <!-- Left Panel - Future Details -->
            <div class="future-details-panel">
                <h3 class="details-header">What's Next For Myriad.ai?</h3>
                <p class="details-description">
                    *Coming updates and improvements for this project in our development pipeline.*
                </p>
                <div class="details-stats">
                    <div class="stat-box">
                        <div class="stat-number">3+</div>
                        <div class="stat-label">Updates</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">100%</div>
                        <div class="stat-label">Open Source</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number">2024</div>
                        <div class="stat-label">Roadmap</div>
                    </div>
                </div>
                <div class="collaborate-section">
                    <h3 class="details-subheader">Want to Collaborate?</h3>
                    <p class="collab-description">
                        *If these ideas spark your interest, let's connect and disrupt the norm together.*
                    </p>
                    <a href="#contact" class="details-link">
                        <span class="details-link-text">Connect Now</span>
                        <span class="details-link-icon">→</span>
                    </a>
                </div>
            </div>
            <!-- Right Panel - Future Timeline -->
            <div class="future-timeline">
                
                <div class="timeline-item" tabindex="0">
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <h3 class="timeline-title">Team Collaboration</h3>
                        <span class="timeline-date">April 2024</span>
                        <p class="timeline-description">
                            Multi-user mode enabling shared codebase exploration and knowledge transfer between teams.
                        </p>
                    </div>
                </div>
                
                <div class="timeline-item" tabindex="0">
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <h3 class="timeline-title">Integration with GitHub Copilot</h3>
                        <span class="timeline-date">May 2024</span>
                        <p class="timeline-description">
                            Seamless workflow between Myriad&#x27;s contextual understanding and GitHub Copilot&#x27;s code generation.
                        </p>
                    </div>
                </div>
                
                <div class="timeline-item" tabindex="0">
                    <div class="timeline-marker"></div>
                    <div class="timeline-content">
                        <h3 class="timeline-title">Custom LLM Fine-tuning</h3>
                        <span class="timeline-date">July 2024</span>
                        <p class="timeline-description">
                            Domain-specific models fine-tuned for particular programming languages and frameworks.
                        </p>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</section>


    <!-- Related Projects Section -->
    
    <section class="related-section">
        <h2 class="section-heading">Related Projects</h2>
        <div class="related-grid">
            
            <a href="/projects/jjugg" class="related-card card-hover">
                <div class="related-image-container">
                    <img src="&#x2F;static&#x2F;images&#x2F;jjugg.jpg" alt="JJugg" />
                </div>
                <div class="related-content">
                    <h3 class="related-title">JJugg</h3>
                    <p class="related-subtitle">Autonomous Job Application Tracker</p>
                </div>
            </a>
            
            <a href="/projects/commitaura" class="related-card card-hover">
                <div class="related-image-container">
                    <img src="&#x2F;static&#x2F;images&#x2F;commitaura.gif" alt="CommitAura" />
                </div>
                <div class="related-content">
                    <h3 class="related-title">CommitAura</h3>
                    <p class="related-subtitle">AI-Powered Commit Message Generator</p>
                </div>
            </a>
            
            <a href="/projects/resumatyk" class="related-card card-hover">
                <div class="related-image-container">
                    <img src="&#x2F;static&#x2F;images&#x2F;resumatyk.jpg" alt="Resumatyk" />
                </div>
                <div class="related-content">
                    <h3 class="related-title">Resumatyk</h3>
                    <p class="related-subtitle">AI Resume Management TUI</p>
                </div>
            </a>
            
        </div>
    </section>
    
</main>

<!-- Modal for image preview -->
<div id="imageModal" class="modal" onclick="if(event.target === this) closeModal();">
    <div class="modal-content">
        <span class="close-modal" onclick="closeModal()">&times;</span>
        <img id="modalImage" src="" alt="">
        <p id="modalCaption" class="modal-caption"></p>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        initDocumentationTabs();
        initDocumentationAnimations();
    });

    function initDocumentationTabs() {
        const navItems = document.querySelectorAll('.docs-nav-item');
        if (navItems.length === 0) return;

        // Preload all documentation content
        document.querySelectorAll('.docs-panel').forEach(panel => {
            // Create a flag to track initialization
            panel.dataset.initialized = 'true';
        });

        // Event delegation for tab switching
        const sidebar = document.querySelector('.docs-sidebar');
        if (sidebar) {
            sidebar.addEventListener('click', (e) => {
                const item = e.target.closest('.docs-nav-item');
                if (!item) return;

                // Remove active class from all nav items
                document.querySelectorAll('.docs-nav-item').forEach(navItem => {
                    navItem.classList.remove('active');
                });

                // Add active class to clicked item
                item.classList.add('active');

                // Hide all content panels efficiently
                document.querySelectorAll('.docs-panel.active').forEach(panel => {
                    panel.classList.add('hidden');
                    panel.classList.remove('active');
                });

                // Show selected panel
                const targetId = item.getAttribute('data-tab');
                const targetPanel = document.getElementById(targetId);
                if (targetPanel) {
                    targetPanel.classList.remove('hidden');
                    targetPanel.classList.add('active');
                }
            });
        }
    }

    function copyToClipboard(button) {
        const command = button.closest('.command-line').querySelector('.terminal-command').innerText;
        navigator.clipboard.writeText(command)
            .then(() => showCopySuccess(button))
            .catch(() => console.error('Failed to copy'));
    }

    function showCopySuccess(button) {
        button.classList.add('copied');
        const originalHTML = button.innerHTML;

        // Confetti animation
        const confettiContainer = button.querySelector('.confetti-container');
        if (confettiContainer) {
            confettiContainer.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = `${Math.random() * 100}%`;
                confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                confettiContainer.appendChild(confetti);
            }
        }

        button.innerHTML = `<svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 6L9 17l-5-5"/>
        </svg><div class="confetti-container"></div>`;

        setTimeout(() => {
            button.classList.remove('copied');
            button.innerHTML = originalHTML;
        }, 2000);
    }

    function openModal(imgElement) {
        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImage');
        const modalCaption = document.getElementById('modalCaption');
        const caption = document.querySelector('.showcase-caption');

        modal.style.display = "flex";
        modal.classList.add('modal-fade-in');
        modalImg.src = imgElement.src;
        modalCaption.textContent = caption ? caption.textContent : '';
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        const modal = document.getElementById('imageModal');
        modal.classList.remove('modal-fade-in');
        modal.classList.add('modal-fade-out');

        setTimeout(() => {
            modal.style.display = "none";
            modal.classList.remove('modal-fade-out');
            document.body.style.overflow = 'auto';
        }, 300);
    }
    
    function initDocumentationAnimations() {
        const observerOptions = {
            root: null,
            rootMargin: '0px 0px -5% 0px',
            threshold: 0.01
        };

        const sectionObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    requestAnimationFrame(() => {
                        entry.target.classList.add('in-view');
                    });
                }
            });
        }, observerOptions);

        // Observe and immediately activate the documentation section if in viewport
        const docSection = document.querySelector('.documentation-section');
        if (docSection) {
            const rect = docSection.getBoundingClientRect();
            if (rect.top < window.innerHeight) {
                docSection.classList.add('in-view');
            } else {
                sectionObserver.observe(docSection);
            }
        }
    }
</script>

        <div class="vertical-name"></div>
    </div>

    <!-- Site scripts -->
    <script src="/static/js/animations.js"></script>
    <script src="/static/js/documentation.js"></script>
    <script src="/static/js/projects.js"></script>
    <script src="/static/js/glitch.js"></script>
    <script src="/static/js/transitions.js"></script>

    <!-- Core functionality -->
    <script>
        // Apply theme from localStorage immediately to avoid FOUC
        (function () {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            }
        })();

        // Initialize Mermaid diagrams - safely check if loaded
        if (typeof mermaid !== 'undefined') {
            mermaid.initialize({
                startOnLoad: true,
                theme: 'neutral',
                flowchart: { curve: 'basis' }
            });
        } else {
            // Add event listener for when mermaid loads
            document.addEventListener('DOMContentLoaded', () => {
                if (typeof mermaid !== 'undefined') {
                    mermaid.initialize({
                        startOnLoad: true,
                        theme: 'neutral',
                        flowchart: { curve: 'basis' }
                    });
                }
            });
        }

        // Theme management system
        document.addEventListener('DOMContentLoaded', () => {
            const navThemeToggleBtn = document.getElementById('nav-theme-toggle');
            const cornerEffects = document.querySelectorAll('.corner-effect');

            // Function to update theme
            function updateTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);

                // Update toggle icon
                const themeIcon = document.querySelector('.theme-icon');
                if (themeIcon) {
                    themeIcon.textContent = theme === 'dark' ? '🌙' : '☀️';
                }

                // Apply subtle animation to corner effects
                cornerEffects.forEach(corner => {
                    corner.style.transition = 'opacity 0.5s ease';
                    corner.style.opacity = '0.5';
                    setTimeout(() => {
                        corner.style.opacity = '0.3';
                    }, 300);
                });
            }

            // Initialize theme from saved preference immediately
            const savedTheme = localStorage.getItem('theme') || 'light';
            // Apply theme without animation for initial load
            document.documentElement.setAttribute('data-theme', savedTheme);
            // Then pass to the update function for icon updates
            updateTheme(savedTheme);

            // Toggle theme on click
            if (navThemeToggleBtn) {
                navThemeToggleBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    const currentTheme = document.documentElement.getAttribute('data-theme');
                    const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                    updateTheme(newTheme);
                });
            }

            // Initialize font dropdown
            function initializeFontDropdown() {
                const dropdown = document.querySelector('.font-dropdown-content');

                // Clear existing content
                dropdown.innerHTML = '';

                // Create font options
                fontOptions.forEach((option, index) => {
                    const fontOption = document.createElement('div');
                    fontOption.className = `font-option ${option.isUbuntuMono ? 'ubuntu-mono' : ''}`;
                    if (parseInt(localStorage.getItem('fontOption') || '0') === index) {
                        fontOption.classList.add('active');
                    }

                    // Apply the display font to the option itself (since that's what we'll use for the name)
                    fontOption.style.fontFamily = option.display;

                    const optionName = document.createElement('span');
                    optionName.className = 'option-name';
                    // Show the display font name instead
                    optionName.textContent = option.name.split(' + ')[1] || option.name.split(' + ')[0];

                    fontOption.appendChild(optionName);
                    fontOption.addEventListener('click', (e) => {
                        e.preventDefault();
                        updateFonts(index);
                    });

                    dropdown.appendChild(fontOption);
                });
            }

            // Toggle fonts on click
            if (fontSwitcherBtn) {
                // Long press to show modal with all font options
                let pressTimer;
                fontSwitcherBtn.addEventListener('mousedown', () => {
                    pressTimer = setTimeout(() => {
                        showFontModal(fontOptions);
                    }, 800);
                });

                fontSwitcherBtn.addEventListener('mouseup', () => {
                    clearTimeout(pressTimer);
                });

                fontSwitcherBtn.addEventListener('mouseleave', () => {
                    clearTimeout(pressTimer);
                });
            }

            // Initialize dropdown on page load
            initializeFontDropdown();

            // Function to show a modal with all font options
            function showFontModal(options) {
                // Remove existing modal if it exists
                const existingModal = document.getElementById('font-modal');
                if (existingModal) {
                    existingModal.remove();
                    return;
                }

                // Create modal
                const modal = document.createElement('div');
                modal.id = 'font-modal';
                modal.style.position = 'fixed';
                modal.style.top = '50%';
                modal.style.left = '50%';
                modal.style.transform = 'translate(-50%, -50%)';
                modal.style.background = 'var(--bg-glass)';
                modal.style.backdropFilter = 'blur(10px)';
                modal.style.padding = '20px';
                modal.style.borderRadius = '8px';
                modal.style.boxShadow = 'var(--shadow-lg)';
                modal.style.zIndex = '10000';
                modal.style.maxWidth = '700px';
                modal.style.width = '90%';
                modal.style.maxHeight = '85vh';
                modal.style.overflowY = 'auto';

                // Add heading
                const heading = document.createElement('h3');
                heading.style.fontFamily = 'var(--font-display)';
                heading.style.marginBottom = '1rem';
                heading.textContent = 'Font Options';
                heading.style.position = 'sticky';
                heading.style.top = '0';
                heading.style.background = 'var(--bg-glass)';
                heading.style.zIndex = '1';
                heading.style.padding = '5px 0';
                heading.style.backdropFilter = 'blur(10px)';
                modal.appendChild(heading);

                // Create search input
                const searchContainer = document.createElement('div');
                searchContainer.style.marginBottom = '15px';
                searchContainer.style.position = 'sticky';
                searchContainer.style.top = '50px';
                searchContainer.style.zIndex = '1';
                searchContainer.style.backdropFilter = 'blur(10px)';
                searchContainer.style.background = 'var(--bg-glass)';
                searchContainer.style.padding = '5px 0';

                const searchInput = document.createElement('input');
                searchInput.type = 'text';
                searchInput.placeholder = 'Search fonts...';
                searchInput.style.width = '100%';
                searchInput.style.padding = '8px 12px';
                searchInput.style.borderRadius = '4px';
                searchInput.style.border = '1px solid var(--color-border)';
                searchInput.style.background = 'var(--bg-glass)';
                searchInput.style.color = 'var(--color-text-primary)';
                searchInput.style.fontFamily = 'var(--font-primary)';
                searchContainer.appendChild(searchInput);
                modal.appendChild(searchContainer);

                // Group fonts by category
                const categories = Array.from(new Set(options.map(opt => opt.category)));

                // Add current font indicator
                const currentOption = parseInt(localStorage.getItem('fontOption') || '0');

                // Create container for font options
                const optionsContainer = document.createElement('div');

                // Function to render font options
                function renderOptions(filter = '') {
                    // Clear previous options
                    optionsContainer.innerHTML = '';

                    // Create font options grouped by category
                    categories.forEach(category => {
                        const categoryFonts = options.filter(o =>
                            o.category === category &&
                            (filter === '' ||
                                o.name.toLowerCase().includes(filter.toLowerCase()) ||
                                category.toLowerCase().includes(filter.toLowerCase())
                            )
                        );

                        // Skip categories with no matching fonts
                        if (categoryFonts.length === 0) return;

                        // Create category group
                        const categoryGroup = document.createElement('div');
                        categoryGroup.style.marginBottom = '20px';

                        // Add category header
                        const categoryHeader = document.createElement('h4');
                        categoryHeader.textContent = category;
                        categoryHeader.style.fontFamily = 'var(--font-display)';
                        categoryHeader.style.fontSize = '1rem';
                        categoryHeader.style.marginBottom = '10px';
                        categoryHeader.style.padding = '5px 0';
                        categoryHeader.style.borderBottom = '1px solid var(--color-border)';
                        categoryGroup.appendChild(categoryHeader);

                        // Create font options list for this category
                        const categoryList = document.createElement('div');
                        categoryList.style.display = 'grid';
                        categoryList.style.gridTemplateColumns = 'repeat(auto-fill, minmax(300px, 1fr))';
                        categoryList.style.gap = '15px';

                        // Add fonts in this category
                        categoryFonts.forEach((option, idx) => {
                            const index = options.indexOf(option);

                            const fontItem = document.createElement('div');
                            fontItem.style.padding = '12px';
                            fontItem.style.cursor = 'pointer';
                            fontItem.style.borderRadius = '4px';
                            fontItem.style.transition = 'all 0.2s ease';
                            fontItem.style.border = '1px solid var(--color-border)';

                            // Highlight current font
                            if (index === currentOption) {
                                fontItem.style.background = 'var(--bg-black-05)';
                                fontItem.style.fontWeight = 'bold';
                                fontItem.style.borderColor = 'var(--color-accent)';
                                fontItem.style.boxShadow = '0 0 0 1px var(--color-accent)';
                            }

                            // Apply the primary font to the item
                            fontItem.style.fontFamily = option.primary;

                            // Create display font preview
                            const displayPreview = document.createElement('div');
                            displayPreview.textContent = 'AaBbCc123';
                            displayPreview.style.fontFamily = option.display;
                            displayPreview.style.fontSize = '1.2em';
                            displayPreview.style.marginBottom = '8px';
                            displayPreview.style.color = 'var(--color-accent)';

                            // Create primary font preview
                            const primaryPreview = document.createElement('div');
                            primaryPreview.textContent = 'AaBbCc123';
                            primaryPreview.style.fontFamily = option.primary;
                            primaryPreview.style.fontSize = '1em';
                            primaryPreview.style.marginBottom = '5px';

                            // Create mono font preview
                            const monoPreview = document.createElement('div');
                            monoPreview.textContent = 'AaBbCc123';
                            monoPreview.style.fontFamily = option.mono;
                            monoPreview.style.fontSize = '0.9em';
                            monoPreview.style.opacity = '0.7';

                            // Create header with font name and status
                            const header = document.createElement('div');
                            header.style.display = 'flex';
                            header.style.justifyContent = 'space-between';
                            header.style.alignItems = 'center';
                            header.style.marginBottom = '10px';

                            const nameSpan = document.createElement('div');
                            nameSpan.textContent = option.name.split(' + ')[0];
                            nameSpan.style.fontWeight = 'bold';

                            const statusSpan = document.createElement('div');
                            if (index === currentOption) {
                                statusSpan.textContent = '✓';
                                statusSpan.style.color = 'var(--color-accent)';
                            }

                            header.appendChild(nameSpan);
                            header.appendChild(statusSpan);

                            // Add all elements to font item
                            fontItem.appendChild(header);
                            fontItem.appendChild(displayPreview);
                            fontItem.appendChild(primaryPreview);
                            fontItem.appendChild(monoPreview);

                            // Add sample text
                            const sampleText = document.createElement('div');
                            sampleText.textContent = 'The quick brown fox jumps over the lazy dog';
                            sampleText.style.marginTop = '10px';
                            sampleText.style.fontSize = '0.85em';
                            sampleText.style.opacity = '0.7';
                            sampleText.style.fontFamily = option.primary;
                            fontItem.appendChild(sampleText);

                            // Set click handler
                            fontItem.addEventListener('click', () => {
                                updateFonts(index);
                                modal.remove();
                            });

                            // Hover effect
                            fontItem.addEventListener('mouseenter', () => {
                                fontItem.style.background = 'var(--bg-black-05)';
                                fontItem.style.transform = 'translateY(-2px)';
                                fontItem.style.boxShadow = 'var(--shadow-md)';
                            });

                            fontItem.addEventListener('mouseleave', () => {
                                if (index !== currentOption) {
                                    fontItem.style.background = 'transparent';
                                    fontItem.style.transform = 'translateY(0)';
                                    fontItem.style.boxShadow = 'none';
                                } else {
                                    fontItem.style.transform = 'translateY(0)';
                                    fontItem.style.boxShadow = '0 0 0 1px var(--color-accent)';
                                }
                            });

                            categoryList.appendChild(fontItem);
                        });

                        categoryGroup.appendChild(categoryList);
                        optionsContainer.appendChild(categoryGroup);
                    });

                    // Show no results message if needed
                    if (optionsContainer.children.length === 0 && filter !== '') {
                        const noResults = document.createElement('div');
                        noResults.textContent = `No fonts matching "${filter}"`;
                        noResults.style.textAlign = 'center';
                        noResults.style.padding = '20px';
                        noResults.style.color = 'var(--color-text-secondary)';
                        optionsContainer.appendChild(noResults);
                    }
                }

                // Add search functionality
                searchInput.addEventListener('input', () => {
                    renderOptions(searchInput.value);
                });

                // Initial render
                renderOptions();
                modal.appendChild(optionsContainer);

                // Add buttons container
                const buttonsContainer = document.createElement('div');
                buttonsContainer.style.display = 'flex';
                buttonsContainer.style.justifyContent = 'space-between';
                buttonsContainer.style.marginTop = '20px';
                buttonsContainer.style.position = 'sticky';
                buttonsContainer.style.bottom = '0';
                buttonsContainer.style.padding = '10px 0';
                buttonsContainer.style.background = 'var(--bg-glass)';
                buttonsContainer.style.backdropFilter = 'blur(10px)';
                buttonsContainer.style.zIndex = '1';

                // Add random button
                const randomBtn = document.createElement('button');
                randomBtn.textContent = 'Random Font';
                randomBtn.style.padding = '8px 16px';
                randomBtn.style.marginRight = '10px';
                randomBtn.style.border = 'none';
                randomBtn.style.borderRadius = '4px';
                randomBtn.style.background = 'var(--bg-black-05)';
                randomBtn.style.cursor = 'pointer';
                randomBtn.style.fontFamily = 'var(--font-primary)';
                randomBtn.style.color = 'var(--color-text-primary)';

                randomBtn.addEventListener('click', () => {
                    const randomIndex = Math.floor(Math.random() * options.length);
                    updateFonts(randomIndex);
                    modal.remove();
                });

                // Add close button
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'Close';
                closeBtn.style.padding = '8px 16px';
                closeBtn.style.border = 'none';
                closeBtn.style.borderRadius = '4px';
                closeBtn.style.background = 'var(--bg-black-05)';
                closeBtn.style.cursor = 'pointer';
                closeBtn.style.fontFamily = 'var(--font-primary)';
                closeBtn.style.color = 'var(--color-text-primary)';

                closeBtn.addEventListener('click', () => {
                    modal.remove();
                });

                buttonsContainer.appendChild(randomBtn);
                buttonsContainer.appendChild(closeBtn);
                modal.appendChild(buttonsContainer);

                // Close modal when clicking outside
                document.addEventListener('click', function closeModalOnOutsideClick(e) {
                    if (!modal.contains(e.target) && e.target !== fontSwitcherBtn) {
                        modal.remove();
                        document.removeEventListener('click', closeModalOnOutsideClick);
                    }
                });

                // Add to body
                document.body.appendChild(modal);

                // Focus search input
                setTimeout(() => {
                    searchInput.focus();
                }, 100);
            }
        });

        // Text scramble effect
        function scrambleText(element, newText, duration = 1000) {
            const letters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
            const oldText = element.textContent;
            const maxLength = Math.max(oldText.length, newText.length);
            const startTime = performance.now();

            function update() {
                const now = performance.now();
                const progress = Math.min((now - startTime) / duration, 1);
                let output = "";
                for (let i = 0; i < maxLength; i++) {
                    if (i < newText.length && progress > i / maxLength) {
                        output += newText[i];
                    } else {
                        output += letters[Math.floor(Math.random() * letters.length)];
                    }
                }
                element.textContent = output;
                if (progress < 1) {
                    requestAnimationFrame(update);
                } else {
                    element.textContent = newText;
                }
            }
            update();
        }

        // Vertical name management
        function morphVerticalName(newText) {
            const vn = document.querySelector('.vertical-name');
            if (vn && vn.textContent !== newText) {
                scrambleText(vn, newText, 200);
            }
        }

        document.addEventListener("DOMContentLoaded", () => {
            // Initialize vertical name
            const verticalName = document.querySelector(".vertical-name");
            if (!verticalName) return;

            morphVerticalName("cybrdelic");

            // Initialize text transform options
            const transformOptions = document.querySelectorAll('.transform-option');
            if (transformOptions.length > 0) {
                transformOptions.forEach(option => {
                    option.addEventListener('click', function () {
                        // Remove active class from all options
                        transformOptions.forEach(opt => opt.classList.remove('active'));

                        // Add active class to clicked option
                        this.classList.add('active');

                        // Get transform type
                        const transform = this.getAttribute('data-transform');

                        // Get hero name element
                        const heroName = document.getElementById('hero-name');

                        // Remove all existing transform classes
                        heroName.classList.remove('uppercase', 'lowercase', 'text-outline', 'text-shadow', 'text-glow');

                        // Add selected transform class if not 'none'
                        if (transform !== 'none') {
                            heroName.classList.add(transform);
                        }

                        // Save preference
                        localStorage.setItem('textTransform', transform);
                    });
                });

                // Apply saved preference if exists
                const savedTransform = localStorage.getItem('textTransform');
                if (savedTransform) {
                    transformOptions.forEach(option => {
                        if (option.getAttribute('data-transform') === savedTransform) {
                            option.click();
                        }
                    });
                }
            }

            // Section navigation mapping
            const displayMap = {
                'hero': 'cybrdelic',
                'projects': 'projects',
                'career': 'timeline',
                'whats-next': 'future',
                'contact': 'contact'
            };

            // Create intersection observer to detect visible section
            const sectionObserver = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && entry.intersectionRatio > 0.3) {
                        const sectionId = entry.target.getAttribute('id');
                        if (sectionId && verticalName.textContent !== sectionId) {
                            const displayText = displayMap[sectionId] || sectionId;
                            morphVerticalName(displayText);
                        }
                    }
                });
            }, {
                threshold: [0.3, 0.6],
                rootMargin: "-10% 0px"
            });

            // Force scroll to top on page load
            window.scrollTo(0, 0);

            // Smooth scroll navigation
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;

                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        const headerHeight = document.querySelector('.nav')?.offsetHeight || 0;
                        const offsetPosition = targetElement.getBoundingClientRect().top + window.pageYOffset - headerHeight;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });

                        history.pushState(null, null, targetId);
                    }
                });
            });

            // Active section highlighting in navigation
            const navObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                        const id = entry.target.getAttribute('id');
                        document.querySelectorAll('.nav a').forEach(link => {
                            link.classList.toggle('active', link.getAttribute('href') === `#${id}`);
                        });
                    }
                });
            }, { threshold: 0.5 });

            // Observe all sections for both effects
            document.querySelectorAll("section[id]").forEach(section => {
                sectionObserver.observe(section);
                navObserver.observe(section);
            });

            // Update after any dynamic content changes
            document.body.addEventListener("htmx:afterSwap", () => {
                document.querySelectorAll("section[id]").forEach(section => {
                    sectionObserver.observe(section);
                    navObserver.observe(section);
                });
            });
        });
    </script>
</body>

</html>
